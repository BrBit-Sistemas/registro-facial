Tabelas criadas:

pessoas - Cadastro principal

usuarios - Controle de acesso

empresa - Dados da empresa/organização

historico_ocorrencias - Registro de ocorrências

varas - Varas judiciais

regime_penal - Regimes penais

tipo_frequencia - Tipos de frequência

motivos_encerramento - Motivos de encerramento

tipos_ocorrencia - Tipos de ocorrências

------------------------------------------------------------------------------------------

CREATE TABLE usuarios (
    ID SERIAL PRIMARY KEY,
    Data_Cadastro TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    Nome VARCHAR(100) NOT NULL,
    Sobrenome VARCHAR(100) NOT NULL,
    Email VARCHAR(150) UNIQUE NOT NULL,
    Senha VARCHAR(255) NOT NULL,
    ID_CPMA_UNIDADE VARCHAR(200),
    Status VARCHAR(20) DEFAULT 'Ativo'
);

-- Criação de índices para melhor performance
CREATE INDEX idx_usuarios_email ON usuarios(Email);
CREATE INDEX idx_usuarios_status ON usuarios(Status);
CREATE INDEX idx_usuarios_nome_sobrenome ON usuarios(Nome, Sobrenome);

-- Opcional: Adicionar comentários nas colunas
COMMENT ON TABLE usuarios IS 'Tabela de usuários do sistema';
COMMENT ON COLUMN usuarios.Email IS 'E-mail do usuário (deve ser único)';
COMMENT ON COLUMN usuarios.Senha IS 'Senha criptografada do usuário';
COMMENT ON COLUMN usuarios.Status IS 'Status do usuário: Ativo, Inativo, Bloqueado, etc.';

INSERT INTO usuarios (
    Nome, Sobrenome, Email, Senha, Status
) VALUES (
    'João', 'Silva', 'joao.silva@email.com', 
    '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 
    'Ativo'
);

////////////////////////////////////////////////////////////////////////////////////////////

CREATE TABLE pessoas (
    ID SERIAL PRIMARY KEY,
    Prontuario VARCHAR(50),
    Data_Cadastro TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    Vara VARCHAR(100),
    Regime_Penal VARCHAR(100),
    Nome_Completo VARCHAR(200) NOT NULL,
    Data_Nascimento DATE,
    RG VARCHAR(20),
    CPF VARCHAR(14),
    Sexo CHAR(1),
    Naturalidade VARCHAR(100),
    Nacionalidade VARCHAR(100),
    Nome_Pai VARCHAR(200),
    Nome_Mae VARCHAR(200),
    Cidade VARCHAR(100),
    UF CHAR(2),
    Contato_1 VARCHAR(50),
    Contato_2 VARCHAR(50),
    Processo VARCHAR(100),
    Motivo_Encerramento TEXT,
    Dados_Adicionais TEXT,
    Foto BYTEA,
    ID_Facial VARCHAR(100),
    ID_CPMA_UNIDADE VARCHAR(200),
    ID_usuario VARCHAR(50),
    Status VARCHAR(50) DEFAULT 'Ativo'
);

-- Criação de índices para melhor performance
CREATE INDEX idx_pessoas_prontuario ON pessoas(Prontuario);
CREATE INDEX idx_pessoas_cpf ON pessoas(CPF);
CREATE INDEX idx_pessoas_nome ON pessoas(Nome_Completo);
CREATE INDEX idx_pessoas_status ON pessoas(Status);

INSERT INTO pessoas (
    Prontuario, Vara, Regime_Penal, Nome_Completo, Data_Nascimento,
    RG, CPF, Sexo, Naturalidade, Nacionalidade,
    Nome_Pai, Nome_Mae, Cidade, UF, Contato_1,
    Contato_2, Processo, Status
) VALUES (
    'PRT12345', '2ª Vara Criminal', 'Fechado', 'João da Silva',
    '1980-05-15', '12.345.678-9', '123.456.789-00', 'M',
    'São Paulo', 'Brasileira', 'José da Silva', 'Maria da Silva',
    'São Paulo', 'SP', '(11) 99999-9999', '(11) 88888-8888',
    'Processo 1234567-89.2023.8.26.0000', 'Ativo'
);

/////////////////////////////////////////////////////////////////////////////////////////////////////////////

CREATE TABLE empresa (
    ID SERIAL PRIMARY KEY,
    Data_Cadastro TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    Razao_Social VARCHAR(200) NOT NULL,
    CNPJ VARCHAR(18) UNIQUE NOT NULL,
    Inscricao_Estadual VARCHAR(20),
    Endereco VARCHAR(200),
    Complemento VARCHAR(100),
    Bairro VARCHAR(100),
    Ponto_Referencia VARCHAR(200),
    Cidade VARCHAR(100),
    UF CHAR(2),
    Contato VARCHAR(50),
    Email VARCHAR(150),
    Site VARCHAR(200),
    Dados_Adicionais TEXT
);

-- Criação de índices para melhor performance
CREATE INDEX idx_empresa_cnpj ON empresa(CNPJ);
CREATE INDEX idx_empresa_razao_social ON empresa(Razao_Social);
CREATE INDEX idx_empresa_cidade_uf ON empresa(Cidade, UF);
CREATE INDEX idx_empresa_email ON empresa(Email);

-- Opcional: Adicionar comentários nas colunas
COMMENT ON TABLE empresa IS 'Tabela de cadastro de empresas';
COMMENT ON COLUMN empresa.CNPJ IS 'CNPJ da empresa (deve ser único)';
COMMENT ON COLUMN empresa.Inscricao_Estadual IS 'Inscrição Estadual (isenta se não houver)';
COMMENT ON COLUMN empresa.UF IS 'Unidade Federativa (2 caracteres)';

-- Campos adicionais que podem ser úteis
ALTER TABLE empresa ADD COLUMN Telefone VARCHAR(20);
ALTER TABLE empresa ADD COLUMN Celular VARCHAR(20);
ALTER TABLE empresa ADD COLUMN CEP VARCHAR(9);
ALTER TABLE empresa ADD COLUMN Responsavel VARCHAR(200);
ALTER TABLE empresa ADD COLUMN Status VARCHAR(20) DEFAULT 'Ativa';

INSERT INTO empresa (
    Razao_Social, CNPJ, Inscricao_Estadual, Endereco, 
    Complemento, Bairro, Ponto_Referencia, Cidade, UF, 
    Contato, Email, Site, Dados_Adicionais
) VALUES (
    'Empresa Exemplo Ltda', '12.345.678/0001-90', '123.456.789.0',
    'Rua das Flores, 123', 'Sala 101', 'Centro', 
    'Próximo ao mercado central', 'São Paulo', 'SP',
    '(11) 99999-9999', 'contato@empresaexemplo.com.br', 
    'www.empresaexemplo.com.br', 'Empresa especializada em...'
);

/////////////////////////////////////////////////////////////////////////////////////////////////

CREATE TABLE historico_ocorrencias (
    ID SERIAL PRIMARY KEY,
    Prontuario VARCHAR(50) NOT NULL,
    Tipo VARCHAR(100) NOT NULL,
    Data DATE NOT NULL,
    Hora TIME NOT NULL,
    Historico TEXT NOT NULL,
    Anexo_Arquivo BYTEA,
    ID_CPMA_UNIDADE VARCHAR(200),
    ID_usuario VARCHAR(50),
    Data_Cadastro TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Criação de índices para melhor performance
CREATE INDEX idx_historico_prontuario ON historico_ocorrencias(Prontuario);
CREATE INDEX idx_historico_data ON historico_ocorrencias(Data);
CREATE INDEX idx_historico_tipo ON historico_ocorrencias(Tipo);
CREATE INDEX idx_historico_data_hora ON historico_ocorrencias(Data, Hora);

-- Opcional: Adicionar chave estrangeira para a tabela pessoas
ALTER TABLE historico_ocorrencias 
ADD CONSTRAINT fk_historico_pessoas 
FOREIGN KEY (Prontuario) 
REFERENCES pessoas(Prontuario) 
ON DELETE CASCADE;

-- Opcional: Adicionar comentários nas colunas
COMMENT ON TABLE historico_ocorrencias IS 'Tabela de histórico de ocorrências dos pacientes';
COMMENT ON COLUMN historico_ocorrencias.Prontuario IS 'Número do prontuário relacionado à ocorrência';
COMMENT ON COLUMN historico_ocorrencias.Tipo IS 'Tipo da ocorrência (Consulta, Incidente, Evolução, etc)';
COMMENT ON COLUMN historico_ocorrencias.Anexo_Arquivo IS 'Arquivo anexado à ocorrência (formato binário)';

-- Campos adicionais que podem ser úteis
ALTER TABLE historico_ocorrencias ADD COLUMN Responsavel VARCHAR(200);
ALTER TABLE historico_ocorrencias ADD COLUMN Severidade VARCHAR(20);
ALTER TABLE historico_ocorrencias ADD COLUMN Status VARCHAR(20) DEFAULT 'Ativo';
ALTER TABLE historico_ocorrencias ADD COLUMN Local_Ocorrencia VARCHAR(100);

INSERT INTO historico_ocorrencias (
    Prontuario, Tipo, Data, Hora, Historico, Usuario_Cadastro
) VALUES (
    'PRT12345', 'Consulta Médica', '2024-01-15', '14:30:00',
    'Paciente compareceu para consulta de rotina. Apresenta melhora significativa nos sintomas relatados anteriormente. Medicação mantida conforme prescrição.',
    'joao.silva'
);

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////

CREATE TABLE varas (
    ID SERIAL PRIMARY KEY,
    Nome VARCHAR(100) NOT NULL UNIQUE,
    Data_Cadastro TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    ID_CPMA_UNIDADE VARCHAR(200),
    ID_usuario VARCHAR(50),
    Status VARCHAR(20) DEFAULT 'Ativa'
);

-- Criação de índices para melhor performance
CREATE INDEX idx_varas_nome ON varas(Nome);
CREATE INDEX idx_varas_status ON varas(Status);

-- Opcional: Adicionar comentários nas colunas
COMMENT ON TABLE varas IS 'Tabela de cadastro de varas judiciais';
COMMENT ON COLUMN varas.Nome IS 'Nome da vara judicial (deve ser único)';
COMMENT ON COLUMN varas.Status IS 'Status da vara: Ativa, Inativa';

-- Inserir alguns dados iniciais comuns
INSERT INTO varas (Nome) VALUES
('1ª Vara Criminal'),
('2ª Vara Criminal'),
('3ª Vara Criminal'),
('1ª Vara da Execução Penal'),
('2ª Vara da Execução Penal'),
('Vara de Crimes contra a Administração Pública'),
('Vara de Entorpecentes'),
('Vara do Juizado Especial Criminal'),
('Vara da Infância e Juventude'),
('Vara de Violência Doméstica');

////////////////////////////////////////////////////////////////////////////////////////////////////////////////

CREATE TABLE regime_penal (
    ID SERIAL PRIMARY KEY,
    Nome VARCHAR(100) NOT NULL UNIQUE,
    Data_Cadastro TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    ID_CPMA_UNIDADE VARCHAR(200),
    ID_usuario VARCHAR(50),
    Status VARCHAR(20) DEFAULT 'Ativo'
);

-- Criação de índices para melhor performance
CREATE INDEX idx_regime_penal_nome ON regime_penal(Nome);
CREATE INDEX idx_regime_penal_status ON regime_penal(Status);

-- Opcional: Adicionar comentários nas colunas
COMMENT ON TABLE regime_penal IS 'Tabela de cadastro de regimes penais';
COMMENT ON COLUMN regime_penal.Nome IS 'Nome do regime penal (deve ser único)';
COMMENT ON COLUMN regime_penal.Status IS 'Status do regime: Ativo, Inativo';

-- Inserir os regimes penais mais comuns
INSERT INTO regime_penal (Nome) VALUES
('Aberto'),
('Semiaberto'),
('Fechado'),
('Domiciliar'),
('Provisório'),
('Livramento Condicional'),
('Saidinha Temporária'),
('Medida de Segurança'),
('Detração Penal'),
('Regime Disciplinar Diferenciado (RDD)');

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////

CREATE TABLE tipo_frequencia (
    ID SERIAL PRIMARY KEY,
    Numero_Dias INTEGER NOT NULL CHECK (Numero_Dias > 0),
    Frequencia VARCHAR(100) NOT NULL UNIQUE,
    Descricao TEXT,
    Data_Cadastro TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    ID_CPMA_UNIDADE VARCHAR(200),
    ID_usuario VARCHAR(50),
    Status VARCHAR(20) DEFAULT 'Ativo'
);

-- Criação de índices para melhor performance
CREATE INDEX idx_tipo_frequencia_dias ON tipo_frequencia(Numero_Dias);
CREATE INDEX idx_tipo_frequencia_nome ON tipo_frequencia(Frequencia);
CREATE INDEX idx_tipo_frequencia_status ON tipo_frequencia(Status);

-- Opcional: Adicionar comentários nas colunas
COMMENT ON TABLE tipo_frequencia IS 'Tabela de tipos de frequência para acompanhamento';
COMMENT ON COLUMN tipo_frequencia.Numero_Dias IS 'Número de dias do ciclo de frequência (deve ser maior que zero)';
COMMENT ON COLUMN tipo_frequencia.Frequencia IS 'Descrição da frequência (única)';
COMMENT ON COLUMN tipo_frequencia.Status IS 'Status do tipo: Ativo, Inativo';

-- Inserir tipos de frequência comuns
INSERT INTO tipo_frequencia (Numero_Dias, Frequencia, Descricao) VALUES
(1, 'Diário', 'Comparecimento todos os dias'),
(2, 'Alternado', 'Comparecimento em dias alternados'),
(7, 'Semanal', 'Comparecimento uma vez por semana'),
(14, 'Quinzenal', 'Comparecimento a cada 15 dias'),
(15, 'Quinzenal Reforçado', 'Comparecimento a cada 15 dias com relatório detalhado'),
(30, 'Mensal', 'Comparecimento uma vez por mês'),
(60, 'Bimestral', 'Comparecimento a cada 2 meses'),
(90, 'Trimestral', 'Comparecimento a cada 3 meses'),
(120, 'Quadrimestral', 'Comparecimento a cada 4 meses'),
(180, 'Semestral', 'Comparecimento a cada 6 meses'),
(365, 'Anual', 'Comparecimento uma vez por ano');

-- Inserir frequências específicas do sistema penal
INSERT INTO tipo_frequencia (Numero_Dias, Frequencia, Descricao) VALUES
(1, 'Comparecimento Diário Obrigatório', 'Comparecimento diário com assinatura'),
(7, 'Relatório Semanal', 'Entrega de relatório semanal de atividades'),
(30, 'Avaliação Mensal', 'Avaliação mensal com equipe técnica'),
(90, 'Revisão Trimestral', 'Revisão trimestral do caso'),
(45, 'Mesmo e Meio', 'Comparecimento a cada 45 dias');

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

CREATE TABLE motivos_encerramento (
    ID SERIAL PRIMARY KEY,
    Nome VARCHAR(100) NOT NULL UNIQUE,
    Data_Cadastro TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    ID_CPMA_UNIDADE VARCHAR(200),
    ID_usuario VARCHAR(50),
    Status VARCHAR(20) DEFAULT 'Ativo'
);

-- Criação de índices para melhor performance
CREATE INDEX idx_motivos_encerramento_nome ON motivos_encerramento(Nome);
CREATE INDEX idx_motivos_encerramento_status ON motivos_encerramento(Status);

-- Opcional: Adicionar comentários nas colunas
COMMENT ON TABLE motivos_encerramento IS 'Tabela de motivos de encerramento de casos';
COMMENT ON COLUMN motivos_encerramento.Nome IS 'Nome do motivo de encerramento (deve ser único)';
COMMENT ON COLUMN motivos_encerramento.Status IS 'Status do motivo: Ativo, Inativo';

-- Inserir motivos de encerramento comuns do sistema penal
INSERT INTO motivos_encerramento (Nome, Status) VALUES
('Cumprimento de Pena', 'Ativo'),
('Progressão de Regime', 'Ativo'),
('Livramento Condicional', 'Ativo'),
('Indulto', 'Ativo'),
('Anistia', 'Ativo'),
('Absolvição', 'Ativo'),
('Prescrição', 'Ativo'),
('Falecimento', 'Ativo'),
('Evadiu-se', 'Ativo'),
('Transferência', 'Ativo'),
('Conversão de Pena', 'Ativo'),
('Decisão Judicial', 'Ativo'),
('Recurso concedido', 'Ativo'),
('Erro processual', 'Ativo'),
('Incompetência do juízo', 'Ativo'),
('Extinção da Punibilidade', 'Ativo'),
('Sursis', 'Ativo'),
('Remição', 'Ativo'),
('Prestação de Serviços à Comunidade', 'Ativo'),
('Monitoramento Eletrônico', 'Ativo'),
('Regime Disciplinar Diferenciado', 'Ativo'),
('Saída Temporária', 'Ativo'),
('Medida de Segurança', 'Ativo'),
('Outro', 'Ativo');

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////

CREATE TABLE tipos_ocorrencia (
    ID SERIAL PRIMARY KEY,
    Nome VARCHAR(100) NOT NULL UNIQUE,
    Data_Cadastro TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    ID_CPMA_UNIDADE VARCHAR(200),
    ID_usuario VARCHAR(50),
    Status VARCHAR(20) DEFAULT 'Ativo'
);

-- Criação de índices para melhor performance
CREATE INDEX idx_tipos_ocorrencia_nome ON tipos_ocorrencia(Nome);
CREATE INDEX idx_tipos_ocorrencia_status ON tipos_ocorrencia(Status);

-- Opcional: Adicionar comentários nas colunas
COMMENT ON TABLE tipos_ocorrencia IS 'Tabela de tipos de ocorrências do sistema';
COMMENT ON COLUMN tipos_ocorrencia.Nome IS 'Nome do tipo de ocorrência (deve ser único)';
COMMENT ON COLUMN tipos_ocorrencia.Status IS 'Status do tipo: Ativo, Inativo';

-- Inserir tipos de ocorrência comuns do sistema penal
INSERT INTO tipos_ocorrencia (Nome, Status) VALUES
('Consulta Médica', 'Ativo'),
('Atendimento Psicológico', 'Ativo'),
('Atendimento Social', 'Ativo'),
('Visita Familiar', 'Ativo'),
('Atividade Laboral', 'Ativo'),
('Atividade Educacional', 'Ativo'),
('Incidente Disciplinar', 'Ativo'),
('Transferência de Célula', 'Ativo'),
('Mudança de Regime', 'Ativo'),
('Progressão de Regime', 'Ativo'),
('Regressão de Regime', 'Ativo'),
('Audiencia Judicial', 'Ativo'),
('Exame Médico', 'Ativo'),
('Entrevista Técnica', 'Ativo'),
('Ocorrência Administrativa', 'Ativo'),
('Solicitação de Benefício', 'Ativo'),
('Pedido de Visita', 'Ativo'),
('Reclamação', 'Ativo'),
('Elogio', 'Ativo'),
('Ocorrência de Saúde', 'Ativo'),
('Medicação Administrada', 'Ativo'),
('Entrada no Sistema', 'Ativo'),
('Saída do Sistema', 'Ativo'),
('Alteração Cadastral', 'Ativo'),
('Atualização de Processo', 'Ativo'),
('Comunicação Interna', 'Ativo'),
('Ocorrência de Segurança', 'Ativo'),
('Busca Pessoal', 'Ativo'),
('Apreensão de Material', 'Ativo'),
('Restrição Disciplinar', 'Ativo'),
('Suspensão de Direitos', 'Ativo'),
('Outros', 'Ativo');